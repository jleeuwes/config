#!/bin/bash

#env DISPLAY=:0.1 wmii &
#env DISPLAY=:0.1 gnome-terminal &
#env DISPLAY=:0.0 wmii   #we wachten op deze om af te sluiten

#if xrandr --screen 1 --prop; then
#  #twee schermen zonder Xinerama
#  SCHERMEN=2
#
#  echo Meerdere schermen
#  export DISPLAY=:0.1
#  xsetroot -display :0.0 -solid black
#  #xset -display :0.0 dpms force off
#  #gnome-screensaver-command --inhibit --reason 'Screensaver crasht met meerdere schermen!' &
#else
#  SCHERMEN=1
#
#  echo Enkel scherm
#fi

#start dbus (uit manpage van dbus-launch)
# Niet nodig: zie /etc/X11/Xsession.d en /etc/X11/Xsession.options
## test for an existing bus daemon, just to be safe
# if test -z "$DBUS_SESSION_BUS_ADDRESS" ; then
#   ## if not found, launch a new one
#   eval `dbus-launch --sh-syntax --exit-with-session`
#   echo "D-Bus per-session daemon address is: $DBUS_SESSION_BUS_ADDRESS"
# fi

~/bin/desktop-decoratie > /dev/null

# Niet nodig: zie /etc/X11/Xsession.d en /etc/X11/Xsession.options
#xrdb -load ~/.Xresources

xsetroot -cursor_name arrow
#unclutter -idle 1 -root &   # nog stees focus-bugs
setxkbmap
# xmodmap ~/.Xmodmap # zou nu in /etc/default/console-setup moeten worden
# geregeld
xset r #keyboard repeat

# niet doen als we Xinerama gebruiken!
gnome-screensaver

#wacht_op_na_inlog() {
#  until pidof dzen2; do
#    sleep 1
#  done
#
#  na_inlog
#}
#
#na_inlog() {
#  sleep 1
#
#  echo '*' rare brede fonts in rxvt weg!
#  xrdb -load ~/.Xresources
#
#  echo '*' zet muiscursor op achtergrond goed #(verdraaid simpel achteraf):
#  xsetroot -cursor_name arrow
#  #echo '*' geen nutteloze muiscursor
#  #unclutter -idle 1 -jitter 2 -root &
# 
#  echo '*' compose key enzo #(vet!)
#  setxkbmap
#
#  echo '*' xmodmap
#  xmodmap ~/.Xmodmap
#
#}

#wacht op grafisch ingelogd zijn met na-inlog-dingen
#wacht_op_na_inlog &

#rm -f /home/jeroen/fiefje
#touch /home/jeroen/fiefje

# echo '*' extra balkje met tijd enzo
# extrabar &

echo '*' xmobar-statusbalk
xmobar < ~/fiefje &

#extrabar_hack() {
#  while [ `pidof dzen2 | wc -w` -ne 2 ]; do
#    pkill extrabar
#    pkill dzen2
#    ~/bin/extrabar &
#    sleep 2
#  done
#}
#extrabar_hack &

ivman -c /etc/ivman

# Niet nodig: zie /etc/X11/Xsession.d en /etc/X11/Xsession.options
#ssh-agent xmonad

# gnome keyring is net iets fijner dan ssh-agent (geen ssh-add nodig)
# eval $(gnome-keyring-daemon)
# export GNOME_KEYRING_SOCKET SSH_AUTH_SOCK GNOME_KEYRING_PID

# gpg-agent is nog fijner
eval $(gpg-agent --daemon --enable-ssh-support)
export GPG_AGENT_PID=$(echo $GPG_AGENT_INFO|cut -d: -f2)

# de /dev/null zorgt ervoor dat grafische dingen niet ten onrechte denken een
# terminal te hebben (bijvoorbeeld ssh-add)
xmonad < /dev/null
pkill ivman #beetje bruut

#kill $GNOME_KEYRING_PID
kill $GPG_AGENT_PID

#if [ "$SCHERMEN" = "2" ]; then
  #xset -display :0.0 dpms force on
#fi
